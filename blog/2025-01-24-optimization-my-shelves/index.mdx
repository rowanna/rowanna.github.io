---
slug: optimization-my-shelves
title: ë‚˜ë§Œì˜ ì±…ì¥ ì˜ˆì œ react ì„±ëŠ¥ìµœì í™” ë° ë¦¬íŒ©í† ë§í•˜ê¸°
authors: [rowanna]
tags: [frontend, react, optimizingPerformance]
---

êµ¬í˜„ëœ ì‘ì€ reactì˜ˆì œ ì„±ëŠ¥ ìµœì í™”í•´ë³´ê¸° - ë¦¬ì•¡íŠ¸ í”„ë¡œíŒŒì¼ëŸ¬ í™œìš©

{/* truncate */}

## ğŸ¤¾ ìš”êµ¬ì‚¬í•­

- **ë‚˜ë§Œì˜ ì±…ì¥** : 3ê°œì˜ ì»´í¬ë„ŒíŠ¸
  - **í˜„ì¬ ì½ê³ ìˆëŠ” ì±…** : ì•„ë˜ ì±… ë¦¬ìŠ¤íŠ¸ ì¤‘ ì½ê³ ì‹¶ì€ ì±…ì— ì½ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ, í•´ë‹¹ ì±…ì„ ê²€ìƒ‰ì°½ ìœ„ì— ë…¸ì¶œ
    - ì½ê³ ìˆëŠ” ì±…ì„ localStorage ì— ì €ì¥í•˜ì—¬ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•´ë„ ì±… ê²€ìƒ‰ì°½ ìœ„ì— ë…¸ì¶œë˜ë„ë¡
  - **ì±… ê²€ìƒ‰ì°½** : ì•„ë˜ ì±… ë¦¬ìŠ¤íŠ¸ ì¤‘ ê²€ìƒ‰í•˜ê³  ì‹¶ì€ ì±…ì´ ìˆì„ ê²½ìš° í…ìŠ¤íŠ¸ ì…ë ¥í•˜ê³  ì—”í„° ëˆ„ë¥´ë©´ ê²€ìƒ‰
  - **ì±… ë¦¬ìŠ¤íŠ¸** : ë‚´ê°€ ê°€ì§„ ëª¨ë“  ì±…ë“¤ì„ ë‚˜ì—´í•˜ì—¬ í‘œê¸°í•œë‹¤
  - **ì±… ìƒì„¸í˜ì´ì§€** : ì±… ë¦¬ìŠ¤íŠ¸ì—ì„œ ì±…ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ì±…ì˜ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
- **ë§Œë“ ì´** : 1ê°œì˜ ì»´í¬ë„ŒíŠ¸ = ì´ë¦„ê³¼ ì´ë©”ì¼ í‘œê¸°
- **ë ˆì´ì•„ì›ƒ** (í—¤ë” + í‘¸í„°) : ëª¨ë“  í˜ì´ì§€ì˜ ìƒë‹¨ê³¼ í•˜ë‹¨ì—ëŠ” ê³µí†µëœ í—¤ë” + í‘¸í„°ê°€ í‘œê¸°ë˜ì–´ì•¼ í•œë‹¤.
  - **ê³ ê°ì„¼í„° í˜ì´ì§€** : ë ˆì´ì•„ì›ƒ í‘¸í„° ë‚´ ê³ ê°ì„¼í„° í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ë§í¬ ì¶”ê°€

## ğŸ¤¾ í´ë” êµ¬ì¡°

```markdown
src
â”œâ”€â”€ assets
â”‚ â”œâ”€â”€ components
â”‚ â”‚ â”œâ”€â”€ Layout
â”‚ â”‚ â”‚ â”œâ”€â”€ Container.jsx
â”‚ â”‚ â”‚ â”œâ”€â”€ Layout.jsx # header, footer í¬í•¨ëœ ë ˆì´ì•„ì›ƒ
â”‚ â”‚ â”œâ”€â”€ BookListDisplay.jsx # ì±… ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
â”‚ â”‚ â”œâ”€â”€ CreatedPerson.jsx # ë§Œë“ ì´ ì»´í¬ë„ŒíŠ¸
â”‚ â”‚ â”œâ”€â”€ MyBookShelvesList.jsx # ë‚˜ë§Œì˜ ì±…ì¥ ì»´í¬ë„ŒíŠ¸(input, í˜„ì¬ì½ê³  ìˆëŠ” ì±…, ì±… ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ í¬í•¨)
â”‚ â”‚ â”œâ”€â”€ ReadingBookDisplay.jsx # í˜„ì¬ ì½ê³ ìˆëŠ” ì±… ì»´í¬ë„ŒíŠ¸
â”‚ â”‚ â””â”€â”€ SearchBookInput.jsx # ê²€ìƒ‰ ì¸í’‹ ì»´í¬ë„ŒíŠ¸
â”‚ â”œâ”€â”€ pages
â”‚ â”‚ â”œâ”€â”€ CustomerPage.jsx # ê³ ê°ì„¼í„° í˜ì´ì§€
â”‚ â”‚ â”œâ”€â”€ DetailPage.jsx # í´ë¦­í•œ ì±… ìƒì„¸ í˜ì´ì§€
â”‚ â”‚ â””â”€â”€ Home.jsx # main í˜ì´ì§€
â”œâ”€â”€ contexts # contextx ê´€ë¦¬ í´ë”
â”‚ â”œâ”€â”€ bookListContexts.jsx
â”‚ â””â”€â”€ readingBookContexts.jsx
â”œâ”€â”€ mock
â”‚ â””â”€â”€ book.js # mock data
â”œâ”€â”€ App.css
â”œâ”€â”€ App.jsx # router ì„¤ì • íŒŒì¼
â”œâ”€â”€ index.css
â””â”€â”€ main.jsx
```

## ğŸ¤¾ ì„±ëŠ¥ìµœì í™”ë¥¼ í•´ë³´ì

### ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì™€ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ props ê²°í•©ë„ë¥¼ ë‚®ì¶”ì.

- ì–´ì°¨í”¼ useContext()ë¥¼ í†µí•´ ì „ì—­ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í• ê±´ë°, ë³µì¡í•˜ê²Œ ë¶€ëª¨ìš”ì†Œì—ì„œ propsë¡œ ë‚´ë ¤ì£¼ì§€ ì•Šì•„ë„ ëœë‹¤. ì˜¤íˆë ¤ ì“¸ë°ì—†ì´ ë¶€ëª¨ìš”ì†Œë§Œ ì¶”ê°€ì ìœ¼ë¡œ ë Œë”ë§ ë  ë¿ì´ë‹¤.

#### ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ ë³€ê²½ ì „

```jsx
// MyBookShelvesList.jsx
import { useContext, useEffect } from "react";
import books from "../../mock/book";
import { readingBookContext } from "../../contexts/readingBookContexts";
import { bookListContexts } from "../../contexts/bookListContexts";
import ReadingBookDisplay from "../components/ReadingBookDisplay";
import SearchBookInput from "../components/SearchBookInput";
import BookListDisplay from "../components/BookListDisplay";

function MyBookShelvesList() {
  const { readingBook, setReadingBook } = useContext(readingBookContext);
  const { setBookList } = useContext(bookListContexts);
  const handleClick = (e) => {
    e.preventDefault();
    const parentElText = e.target.parentElement.innerText;
    const selectedBookTitle = parentElText.split("-")[0];

    setReadingBook(selectedBookTitle);
    localStorage.setItem("readingBook", selectedBookTitle);
  };

  useEffect(() => {
    localStorage.getItem("readingBook") &&
      setReadingBook(localStorage.getItem("readingBook"));

    setBookList(books);
  }, []);

  return (
    <>
      <ReadingBookDisplay readingBook={readingBook} />
      <SearchBookInput />
      <BookListDisplay onClick={handleClick} />
    </>
  );
}

export default MyBookShelvesList;
```

ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ê°€ ì§€ë‚˜ì¹˜ê²Œ ë¡œì§ì„ ë§ì´ ê°€ì§€ê³  ìˆëŠ” ê±¸ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

#### ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ ë³€ê²½ í›„

```jsx
import ReadingBookDisplay from "../components/ReadingBookDisplay";
import SearchBookInput from "../components/SearchBookInput";
import BookListDisplay from "../components/BookListDisplay";

function MyBookShelvesList() {
  return (
    <>
      <ReadingBookDisplay />
      <SearchBookInput />
      <BookListDisplay />
    </>
  );
}

export default MyBookShelvesList;
```

### React.memo, useMemo, useCallbackì„ ì„±ëŠ¥ ìµœì í™” í•´ë³´ê¸°

- `React.memo` : ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ìì²´ë¥¼ ì €ì¥
- `useMemo` : í•¨ìˆ˜ì˜ ê²°ê³¼ê°’ ì €ì¥
- `useCallback` : í•¨ìˆ˜ êµ¬í˜„ì²´ ìì²´ë¥¼ ì €ì¥

#### BookListDisplay.jsx

```jsx
import { bookListContexts } from "../../contexts/bookListContexts";
import { readingBookContext } from "../../contexts/readingBookContexts";
import { useContext, memo, useEffect, useCallback } from "react";
import { Link } from "react-router-dom";
import books from "../../mock/book";

const BookListDisplay = memo(function BookListDisplay() {
  const { setReadingBook } = useContext(readingBookContext);
  const { bookList } = useContext(bookListContexts);
  const { setBookList } = useContext(bookListContexts);

  useEffect(() => {
    setBookList(books);
  }, []);
  // âœ¨ ì—¬ê¸°!!
  const handleClick = useCallback((e) => {
    e.preventDefault();
    const parentElText = e.target.parentElement.innerText;
    const selectedBookTitle = parentElText.split("-")[0];

    setReadingBook(selectedBookTitle);
    localStorage.setItem("readingBook", selectedBookTitle);
  });
  return (
    <>
      <ul>
        {bookList.map(({ title, author, id }) => (
          <li key={id}>
            <Link to={`/detail/${id}`}>
              {title}-{author}
              <button
                onClick={handleClick}
                style={{ padding: "0.2rem 0.4rem", marginLeft: 4 }}
              >
                ì½ê¸°
              </button>
            </Link>
          </li>
        ))}
      </ul>
    </>
  );
});

export default BookListDisplay;
```

`handleClick` í•¨ìˆ˜ëŠ” onClick ì´ë²¤íŠ¸ê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ìƒì„±ë˜ì§€ ì•Šë„ë¡ useEffectë¥¼ ì ìš©í•´ì£¼ì—ˆë‹¤.

#### SearchBookInput.jsx

```jsx
import { useCallback, useContext, useRef } from "react";
import { bookListContexts } from "../../contexts/bookListContexts";
import books from "../../mock/book";
function SearchBookInput() {
  const inputRef = useRef("");
  const { setBookList } = useContext(bookListContexts);

  // âœ¨ ì—¬ê¸°!!
  const handleKeyupEvent = useCallback((e) => {
    const searchWord = inputRef.current.value;

    if (e.key !== "Enter" || !searchWord.trim()) return;

    const searchedBookList = books.filter(({ title }) =>
      title.includes(searchWord)
    );
    setBookList(searchedBookList);
  });
  return <input onKeyUp={handleKeyupEvent} ref={inputRef} />;
}

export default SearchBookInput;
```

`handleKeyupEvent` ì´ë²¤íŠ¸ë„ ìœ„ì™€ ë™ì¼í•´ì„œ `useCallback`ì„ ì ìš©í–ˆë‹¤.

#### ì „

![alt text](image-3.png)

#### í›„

![alt text](image-4.png)

í° ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë¼ì„œ Render durationì€ í¬ê²Œ ì°¨ì´ë‚˜ì§€ ì•Šì§€ë§Œ êµ³ì´ ë Œë” ë˜ì§€ì•Šì•„ë„ ë  ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ê°€ ë Œë” ë˜ì§€ì•ŠìŒì„ í™•ì¸í–ˆë‹¤. ê·¸ë¦¬ê³  ì „ì—ì„œëŠ” 3ê°œì˜ ëª¨ë“  ìì‹ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë˜ì—ˆëŠ”ë°, useContextë¡œ ë°ì´í„°ê°€ ë°”ë€ŒëŠ” 2ê°œì˜ ì»´í¬ë„ŒíŠ¸ë§Œ ë Œë”ë§ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

## ğŸ¤¾ ì„±ëŠ¥ìµœì í™” ì™„ë£Œ

<video width="100%" controls>
  <source src="/before.mov" />
</video>

## ğŸ¤¾ ì„±ëŠ¥ìµœì í™” ì™„ë£Œ

[ì‚¬ì´íŠ¸ ë³´ëŸ¬ê°€ê¸°](https://rowanna.github.io/my-react-bookshelves/)
